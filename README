created by duanjigang1983<duanjigang1983@gmail.com> for cmtk at 2011-09-19

cmtk/cmtkd is a system tool used to access many hosts parallelly, with cmtk/cmtkd, you may
run a command on a host or transfer a file to a host. moreover, cmtk/cmtkd will help you to access
thousands of hosts quickly with the help of multi-threaded programming.

============================================================================================
what is shown in this file?

1) how to compile the source of cmtk and cmtkd
2) make rpms of cmtk and cmtkd so that you may install them on another computer
3) configure cmtk/cmtkd
4) do your job with the help of cmtk/cmtkd

==================================================================

1) COMPILE THE SOURCE CODE
	
 Cmtk communicates with cmtkd based on the ICE (Internet Communications Engine, www.zeroc.com) but not the standard tcp socket. we want the communication to be simple and strong, and more developers with diffrent computer languages on diffrent platform may join in the cmtk, so ICE was selected but not the standard tcp socket.
	
   To compile the source code of cmtk/cmtkd,  ICE develop components is needed to install.
	firstly, download Ice-3.3.1.tar.gz and mcpp-2.7.2.tar.gz, or you may download it from my git:
	
		git clone git://github.com/duanjigang1983/ice-libs.git
	after getting the Ice tar and mcpp tar. try to install them.
Install mcpp

	tar -zxvf mcpp-2.7.2.tar.gz
	cd mcpp-2.7.2
	./configure CFLAGS=-fPIC -enable-mcpplib -enable-shared
	make 
	make install
	ldconfig
Install Ice
	tar -zxvf Ice-3.3.1.tar.gz
	cd Ice-3.3.1/
	cd cpp

	
then change the content of 'prefix' in file "config/Make.rules",default value is:
	prefix                   ?= /opt/Ice-$(VERSION)
we change it to
	prefix                   ?= /usr/local/Ice-$(VERSION)
and now, the working directory is "....Ice-3.3.1/cpp"
	just enter the make and make install command
		make
		make install

attention, when the compiler complains something like "can not find bzlib.h" during the ICE is compiled, try to resolve this by install
then bzip2-devel:
yum install bzip2-devel
and so is expat-devel and db4-devel when expat and db can not be found.


	then, mcpp and ice is successfully installed.


Compiling cmtk and cmtkd.
	To get the source code, run command:
	git clone git://github.com/duanjigang1983/cmtkit.git
then you will get the source dir of cmtkit, which consists of 

		README 		a file
		cmtkitd 	a shell script file to install the cmtkd as a service
		cmtk		a directory where the code of cmtk exists
		cmtkctl		a directory where code of cmctk is stored
		cmtkd		a directory for source code of cmtkd
compile cmctl:
	cd cmctl
	make
then you will get the command cmctl to control cmtk and cmtkd.

compile cmtk
	cd cmtk
	make
	then you get command cmtk to run command
compile cmtkd
	cd cmtkd
	make 
	then you get command cmtkd which will run on all server just like the sshd

If there are any errors in your compiling, just check the Makefile and your installing position of Ice and MCPP.

	sofar, all compiling of cmtkid is OK
===========================================================================

2) MAKE RPMS
 
Cmtkit is a system managment tool, so you may install it on thounds of computers, then, install cmtkit from the source code is not a clever way. then rpm installing is an efficient way for your installing job.
 In the source directory of cmtk and cmtkd, there is each a .spec for the rpm building job. if you are not familiar with
the rpm command and spec file, just do what as i tell u. either, you are expert at spec file and rpmbuild, change these
spec files as you want, or you may write your own spec files to get the rpms as your will.

In next steps, how to do is told  in this document but not all the reasons for what you do. if you want to get detailed 
information of the spec file and rpmbuild command ,just ask help from google or man book.

	MAKING RPM FOR CMTK
			; change dire
			cd cmtkit/cmtk
			;copy spec files
			cp cmtk.spec /usr/src/redhat/SPECS/
			;make the source tar 
			tar -czf cmtk.tar.gz *
			;move source tar to dest dir
			mv cmtk.tar.gz  /usr/src/redhat/SOURCES/
			;change dir to SPE and try to build your rpms
			cd /usr/src/redhat/SPECS/
			rpmbuild -bb cmtk.spec (you must do it as root or sudo)
	if no error is print out, the rpm is built out successfully.
	when you are woking on a box of bit64, try to run command :
				ls ../RPMS/x86_64/
	or when you are on a box of bit32,try command :
				ls ../RPMS/i386
	then, you will get the rpm files, for example:
			cmtk-1.0.1-1.el5.x86_64.rpm
	For cmtkd:
		cp cmtkd.spec /usr/src/redhat/SPECS/
		tar -czf cmtkd.tar.gz *
		mv cmtkd.tar.gz /usr/src/redhat/SOURCES/
		cd /usr/src/redhat/SPECS/
		rpmbuild -bb cmtkd.spec
	then we get: cmtkd-1.0.1-1.el5.x86_64.rpm
		
	more over, cmtkctl need to be generated:
	cd cmtkctl/
	make
	cmtkctl is used to managed the autorized file of cmtk/cmtkd.


3)CONFIGURE CMTK AND CMTKD


4)USING IT IN YOUR JOB
test
